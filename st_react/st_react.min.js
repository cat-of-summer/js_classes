class st_modal{static instance=Symbol();overlay;container;target;#t;static#e(t){if(t instanceof Element)return t;try{return document.querySelector(t)||(()=>{throw new Error})()}catch{return document.body.appendChild((new DOMParser).parseFromString(t,"text/html").body.firstElementChild)}}static find(t){return t[st_modal.instance]}constructor(t){t={zIndex:1e3,duration:.3,container:"body",overlay:!0,overlay_shading:.5,overlay_blur:"5px",overlay_scroll_lock:!0,location:"center center",position:"fixed",overflow:"auto",close_by_out:!0,close_by_esc:!0,auto_close:-1,close_button_attribute:'action="close"',state_attrubite:"state",allow_interrupt:!1,showing_state:"showing",shown_state:"shown",hiding_state:"hiding",hidden_state:"hidden",before_open:()=>{},on_open:()=>{},before_close:()=>{},on_close:()=>{},...t};let e,s=[],a=[];t.overlay&&(t.zIndex++,this.overlay=document.createElement("overlay"),this.overlay[st_modal.instance]=this,Object.assign(this.overlay.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:`rgba(0, 0, 0, ${t.overlay_shading})`,backdropFilter:`blur(${t.overlay_blur})`,zIndex:t.zIndex,transition:`all ${t.duration}s`,display:"none"}),this.overlay.setAttribute(t.state_attrubite,t.hidden_state),t.close_by_out&&this.overlay.addEventListener("click",(()=>this.hide())),a.push(this.overlay)),this.container=document.createElement("container"),this.container[st_modal.instance]=this,Object.assign(this.container.style,{position:t.position,overflow:t.overflow,width:"max-content",maxWidth:"100%",height:"max-content",zIndex:t.zIndex+1,transition:`all ${t.duration}s`,display:"none",...{"top left":{top:0,left:0},"top center":{top:0,left:"50%",transform:"translateX(-50%)"},"top right":{top:0,right:0},"center left":{top:"50%",left:0,transform:"translateY(-50%)"},"center center":{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},"center right":{top:"50%",right:0,transform:"translateY(-50%)"},"bottom left":{bottom:0,left:0},"bottom center":{bottom:0,left:"50%",transform:"translateX(-50%)"},"bottom right":{bottom:0,right:0}}[t.location]}),this.container.setAttribute(t.state_attrubite,t.hidden_state),a.push(this.container),this.target=st_modal.#e(t.target),this.target[st_modal.instance]=this,this.target.style.transition=`all ${t.duration}s`,this.container.append(this.target),this.target.querySelectorAll(`[${t.close_button_attribute}]`).forEach((t=>{t.addEventListener("click",(()=>this.hide()))})),t.close_by_out&&document.addEventListener("click",(t=>{this.container.contains(t.target)||this.hide()})),t.close_by_esc&&document.addEventListener("keydown",(t=>{"Escape"!==t.code&&27!==t.keyCode||this.hide()}));let n=(e,n,o,i,r)=>{e(),a.forEach(((e,a)=>{clearTimeout(s[a]),e.style.display="block",s[a]=setTimeout((()=>{this.#t=i,e.setAttribute(t.state_attrubite,this.state),r&&(e.style.display="none"),n()}),1e3*t.duration),requestAnimationFrame((()=>{this.#t=o,e.setAttribute(t.state_attrubite,this.state)}))}))};this.show=(a=!1)=>{(this.#t==t.hidden_state||t.allow_interrupt&&this.#t==t.hiding_state||a)&&(n(t.before_open,t.on_open,t.showing_state,t.shown_state,!1),t.overlay_scroll_lock&&this.overlay&&(e=document.body.style,e={position:e.position,top:e.top,left:e.left,scroll_Y:window.scrollY||document.documentElement.scrollTop,scroll_X:window.scrollX||document.documentElement.scrollLeft},Object.assign(document.body.style,{position:"fixed",top:`-${e.scroll_Y}px`,left:`-${e.scroll_X}px`})),t.auto_close>0&&(clearTimeout(s[2]),s[2]=setTimeout((()=>{this.hide(!0)}),1e3*t.auto_close)))},this.hide=(s=!1)=>{(this.#t==t.shown_state||t.allow_interrupt&&this.#t==t.showing_state||s)&&(n(t.before_close,t.on_close,t.hiding_state,t.hidden_state,!0),e&&(Object.assign(document.body.style,e),window.scrollTo(e.scroll_X,e.scroll_Y)))},this.#t=t.hidden_state,st_modal.#e(t.container).append(...a)}get state(){return this.#t}}class st_react extends HTMLElement{static#s="st-react";static#a={url:void 0,method:"POST",before_attach:()=>{},on_attach:()=>{},on_detach:()=>{},before_state_add:()=>{},before_state_set:()=>{},on_state_add:()=>{},on_state_set:()=>{},before_send:()=>{},on_send:()=>{},on_send_success:()=>{},on_send_failed:()=>{}};static{customElements.define(st_react.#s,this)}static new(){return document.createElement(st_react.#s)}static spoof(t){let e=document.createElement(st_react.#s);return Array.from(t.attributes).forEach((t=>e.setAttribute(t.name,t.value))),e.replaceChildren(...t.childNodes),e.className=t.className,e.style.cssText=t.style.cssText,e.className=t.className,e.style.cssText=t.style.cssText,Object.assign(e.dataset,t.dataset),["value","checked","selected"].forEach((e=>e in t&&(obj[e]=t[e]))),t.replaceWith(e),e}#n={};#o=null;#i={};constructor(){super(),this.dispatchEvent(new CustomEvent("before_attach",{bubbles:!1,cancelable:!0})),this.state.before_attach()}get state(){return null!==this.#o?this.#n[this.#o]:st_react.#a}set_observer(t){if("function"!=typeof(t={childList:!0,attributes:!0,subtree:!0,observe_list:null,observe_mutation:null,...t}).observe_list&&"function"!=typeof t.observe_mutation)return;let e=new MutationObserver(((e,s)=>{t.observe_list&&t.observe_list(e,s),t.observe_mutation&&e.forEach((t=>observe_mutation(t,s)))}));return e.observe(this,{childList:t.childList,attributes:t.attributes,subtree:t.subtree}),e}set_state(t,e=null){let s=this.#o,a=this.#n[s],n=(t,e)=>{this.dispatchEvent(new CustomEvent("before_state_add",{detail:{key:t,data:e},bubbles:!1,cancelable:!0})),this.state.before_state_add(t,e),this.#n[t]={...st_react.#a,...e},this.dispatchEvent(new CustomEvent("on_state_add",{detail:{key:s,data:a},bubbles:!1,cancelable:!0})),this.state.on_state_add(s,a)},o=t=>{this.dispatchEvent(new CustomEvent("before_state_set",{detail:{key:t,data:this.#n[t]},bubbles:!1,cancelable:!0})),this.state.before_state_set(t,this.#n[t]),this.#o=t,this.dispatchEvent(new CustomEvent("on_state_set",{detail:{key:s,data:a},bubbles:!1,cancelable:!0})),this.state.on_state_set(s,a)};"string"==typeof t?e?n(t,e):t in this.#n&&o(t):"object"==typeof t&&(n(0,t),o(0))}send(t={}){try{t={url:this.state.url,method:this.state.method,data:this.dataset,before_send:this.state.before_send,on_send:this.state.on_send,on_send_success:this.state.on_send_success,on_send_failed:this.state.on_send_failed,...t};let e=!1,s=s=>{if(!e){let n={status:a.status||void 0,statusText:a.statusText||"",response:s instanceof ProgressEvent?a.responseText:s};this.dispatchEvent(new CustomEvent("on_send_failed",{detail:n,bubbles:!1,cancelable:!0})),t.on_send_failed(n),e=!0}},a=new XMLHttpRequest;a.onreadystatechange=()=>{if(4!==a.readyState)return;if(a.status<200||a.status>=300)return s();let e={data:a.responseText,request:a};this.dispatchEvent(new CustomEvent("on_send_success",{detail:e,bubbles:!1,cancelable:!0})),t.on_send_success(...e)},a.onerror=s,a.open(t.method,t.url,!0),this.dispatchEvent(new CustomEvent("before_send",{bubbles:!1,cancelable:!0})),t.before_send(),"object"!=typeof t.data||t.data instanceof FormData?a.send(t.data):(a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify(t.data))),this.dispatchEvent(new CustomEvent("on_send",{bubbles:!1,cancelable:!0})),t.on_send()}catch(t){handle_error(t)}}connectedCallback(){this.dispatchEvent(new CustomEvent("on_attach",{bubbles:!1,cancelable:!0})),this.state.on_attach()}disconnectedCallback(){this.dispatchEvent(new CustomEvent("on_detach",{bubbles:!1,cancelable:!0})),this.state.on_detach()}}