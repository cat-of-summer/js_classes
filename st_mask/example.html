<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="st_mask.js"></script>

    <style>
        form {
            display: flex;
            flex-direction: column;
            width: 100px;
            gap: 10px;
            margin-top: 20px;
        }
    </style>

</head>
<body>

<form action="/" method="GET">
    <label>
        PHONE
        <input type="phone" name="PHONE">
    </label>
    <label>
        DATE
        <input type="text" name="DATE">
    </label>
    <button type="submit">Активация</button>
</form>

<script>

    function if_full(input) { //Функция, делающая поле "валидным"
        input.style.background = 'green';
        input.removeAttribute('invalid');
    }

    function if_not_full(input) { //Функция, делающая поле "инвалидным"
        input.style.background = 'red';
        input.setAttribute('invalid', '');
    }

   new st_mask({
        selector: 'input[type=phone]',
        masks: [
            "+{{7}} ({3*{\\d}}) {2*{\\d}} - {2*{\\d}} - {2*{\\d}}",
            "{{8}} ({3*{\\d}}) {2*{\\d}} - {2*{\\d}} - {2*{\\d}}",
            "+{{9}}99 ({3*{\\d}}) {2*{\\d}} - {2*{\\d}} - {2*{\\d}}",
        ],
        placeholder: false,
        default_filler: '_',
        callback: function(input, mask) {
            if (mask.is_full)
                if_full(input)
            else
                if_not_full(input)
        }
    });

    date_masks = new st_mask({
        selector: 'input[name=DATE]',
        callback: function(input, mask) {
            if (mask.is_full)
                if_full(input)
            else if (mask.progress > 0)
                if_not_full(input)
            else 
                input.style.background = 'white';
        }
    });

    date_masks.set_masks([
        "{2*{\\d}=D} {2*{\\d}=M} {4*{\\d}=Y}",
        "{2*{\\d}=Д} {2*{\\d}=M} {4*{\\d}=Г}",
        "{2*{\\d}=день} {2*{\\d}=месяц} {4*{\\d}=год}",
    ]);
    date_masks.remove_mask(1);
    date_masks.add_mask("{2*{\\d}=день} {2*{\\d}=месяц} {4*{\\d}=год}");

    document.querySelector('form').addEventListener('submit', function(event) { //Валидация всей формы
        event.preventDefault();

        for (let input of this.querySelectorAll('input')) 
            if (input.hasAttribute('invalid')) {
                alert("Валидация не пройдена!");
                return;
            }
        
        this.submit();
    })
</script>

</body>
</html>